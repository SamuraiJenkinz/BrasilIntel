{% extends "admin/base.html" %}
{% block title %}Recipients{% endblock %}

{% block content %}
<div class="page-header">
    <h2><i class="bi bi-people me-2"></i>Recipients</h2>
    <p class="text-muted mb-0">View email recipients configured for each category.</p>
</div>

<div class="alert alert-info mb-4">
    <i class="bi bi-info-circle me-2"></i>
    <strong>Note:</strong> Recipients are configured via environment variables.
    Edit your <code>.env</code> file to modify recipient lists.
</div>

{% for cat in categories %}
<div class="card mb-3">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
            <i class="bi bi-envelope me-2"></i>{{ cat }}
        </h5>
        {% if recipients[cat].has_recipients %}
        <span class="badge bg-success">
            <i class="bi bi-check-circle me-1"></i>Configured
        </span>
        {% else %}
        <span class="badge bg-warning text-dark">
            <i class="bi bi-exclamation-triangle me-1"></i>Not configured
        </span>
        {% endif %}
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <h6 class="text-muted mb-2">
                    <i class="bi bi-person-fill me-1"></i>TO (Primary)
                </h6>
                {% if recipients[cat].to %}
                <ul class="list-unstyled mb-0">
                    {% for email in recipients[cat].to %}
                    <li class="mb-1"><code>{{ email }}</code></li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted mb-0 fst-italic">None configured</p>
                {% endif %}
            </div>
            <div class="col-md-4">
                <h6 class="text-muted mb-2">
                    <i class="bi bi-person me-1"></i>CC (Copy)
                </h6>
                {% if recipients[cat].cc %}
                <ul class="list-unstyled mb-0">
                    {% for email in recipients[cat].cc %}
                    <li class="mb-1"><code>{{ email }}</code></li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted mb-0 fst-italic">None configured</p>
                {% endif %}
            </div>
            <div class="col-md-4">
                <h6 class="text-muted mb-2">
                    <i class="bi bi-person-dash me-1"></i>BCC (Hidden)
                </h6>
                {% if recipients[cat].bcc %}
                <ul class="list-unstyled mb-0">
                    {% for email in recipients[cat].bcc %}
                    <li class="mb-1"><code>{{ email }}</code></li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted mb-0 fst-italic">None configured</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endfor %}

<div class="card mt-4">
    <div class="card-header">
        <i class="bi bi-book me-2"></i>Environment Variable Reference
    </div>
    <div class="card-body">
        <p class="mb-3">
            Configure recipients by setting these environment variables in your <code>.env</code> file:
        </p>
        <div class="table-responsive">
            <table class="table table-sm table-bordered mb-3">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>TO Variable</th>
                        <th>CC Variable</th>
                        <th>BCC Variable</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Health</strong></td>
                        <td><code>REPORT_RECIPIENTS_HEALTH</code></td>
                        <td><code>REPORT_RECIPIENTS_HEALTH_CC</code></td>
                        <td><code>REPORT_RECIPIENTS_HEALTH_BCC</code></td>
                    </tr>
                    <tr>
                        <td><strong>Dental</strong></td>
                        <td><code>REPORT_RECIPIENTS_DENTAL</code></td>
                        <td><code>REPORT_RECIPIENTS_DENTAL_CC</code></td>
                        <td><code>REPORT_RECIPIENTS_DENTAL_BCC</code></td>
                    </tr>
                    <tr>
                        <td><strong>Group Life</strong></td>
                        <td><code>REPORT_RECIPIENTS_GROUP_LIFE</code></td>
                        <td><code>REPORT_RECIPIENTS_GROUP_LIFE_CC</code></td>
                        <td><code>REPORT_RECIPIENTS_GROUP_LIFE_BCC</code></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="alert alert-secondary mb-0">
            <i class="bi bi-lightbulb me-2"></i>
            <strong>Example:</strong> Use comma-separated email addresses.<br>
            <code class="d-block mt-2">REPORT_RECIPIENTS_HEALTH=user1@example.com, user2@example.com</code>
        </div>
    </div>
</div>
{% endblock %}
